# 简介
大西南项目的用户系统解析，以及设计原理。

# 0、接口设计
## 1.1、关于名称
**name**字段是敏感字段，所以在系统中废除了。
但是这个属性其实是很多记录的通用属性，可谓弃之可惜。因此为了保留一定的特性，在使用名称获取数据的请求上，我们都使用`name`作为请求参数。而其他的请求接口上，还是和具体的实体语义协调一致请求才行。例如，请求用户列表的时候，用户姓名这个查询的key应该为`username`而不是`name`，请诸君注意。

# 1、部门设计
## 1.1、初版
首先，用户和职工是两个不同的概念，但是他们共享同一个部门架构。既然如此，就将整个系统映射为一棵部门树即可。

``` 
|- 集团
|-- -- 集团部门层级1
|-- -- 集团部门层级2
|-- -- ...
|-- -- 集团部门层级n
|-
|- 煤矿平台1
|- 煤矿平台2
|- 煤矿平台3
|- ...
|- 煤矿平台n
|-- -- 煤矿部门层级1
|-- -- 煤矿部门层级2
|-- -- ...
|-- -- 煤矿部门层级n
```
首先为了区别集团和煤矿，我们需要一个标志字段标明该资源属于哪一种类型，即:
```
DEPARTMENT_TYPE = {
    COMPANY_GROUP("集团公司所属部门"),
    CM_PLATFORM("煤矿平台所属部门");
}
```

那么，显然系统中需要标志几个元素，我们只需按如下的规则判断即可

* 集团的对应记录 —— 父部门为0，资源类型为0(COMPANY_GROUP)
* 集团子部门对应的记录 —— 父部门不为0，资源类型为0(COMPANY_GROUP)
* 煤矿平台的对应记录 —— 父部门为0，资源类型为1(CM_PLATFORM)
* 煤矿平台的子部门对应的记录 —— 父部门不为0，资源类型为1(CM_PLATFORM)

# 2、用户系统设计
用户系统和职工需要区分开来，默认情况下，只有一个超级管理员账号，其等价于平台账号。平台账号拥有最高权限，可以对系统中的任何资源进行操控，默认情况下，我们将其设置为(admin:admin)。

初始阶段，超管可以通过煤矿平台管理页面创建煤矿平台。这时候，会生成3个元素：

* 元素一：煤矿平台的记录信息；
* 元素二：煤矿平台对应的顶层部门信息；
* 元素三：煤矿平台对应的管理用户信息，并将该用户的所属部门设置为该煤矿平台顶层部门的一个用户；


# 3、日报
## 3.1、打孔日报
* 打孔日报具有不可重复性，判别重复的标准是：同一日期、同一班次、同一队伍不能同时一样，这样的记录应该是用作修改的。

# 职工系统设计
职工系统只需单纯的管理职工信息即可。

# 4、权限控制
* 集团公司进入界面可以看到所有数据，煤矿平台看到的是和自己相关的

